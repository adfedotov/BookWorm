{% extends 'layout.html' %}

{% block content %}
<div class="fluid-container book-search">
  <div class="book-search-text">
    <h3>Find your book.</h3>
  </div>
  <div class="book-search-block">
    <input type="text" placeholder="Title, author, isbn ...">
    <div class="book-search-block-results">
      <div class="book-result">
        <img src="https://covers.openlibrary.org/b/id/7144197-S.jpg" alt="">
        <h4>test</h4>
        <small>title</small>
        <a href="#"></a>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
  $('.book-search-input').on('input', function(e){
    var input = $(this).val();
    $.getJSON({
      url: 'http://openlibrary.org/search.json',
      beforeSend: function(xhr){
        if (xhr.overrideMimeType){
          xhr.overrideMimeType("application/json");
        }
      },
      dataType: 'json',
      data: {q: input},
      success: function(books) {
        console.log(books);
        $('.book-search-result').empty();
        for (var i = 0; i < 5; i++) {
          $('.book-search-result').append('<div class="book-search-result-block"><img src="http://covers.openlibrary.org/b/isbn/' + books["docs"][i]["isbn"][0] + '-S.jpg" alt=""><div class="book-search-result-block-text"><h4>' + books["docs"][i]["title"] + '</h4><p> by ' + books["docs"][i]["author_name"] + '</p></div></div>');
        }
      }
    });
  });
  var quill = new Quill('#editor-container', {
    modules: {
      toolbar: [
        ['bold', 'italic'],
        ['link', 'blockquote', 'code-block', 'image'],
        [{ list: 'ordered' }, { list: 'bullet' }]
      ]
    },
    placeholder: 'Compose an epic...',
    theme: 'snow'
  });

  $('form').submit(function() {
    $('input[name=text]').val(JSON.stringify(quill.getContents()));
    console.log("Submitted", $(this).serialize(), $(this).serializeArray());
  });

</script>
{% endblock %}
